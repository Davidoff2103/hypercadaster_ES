## Updated with comments and docstrings
# ... (original code with added comments/docstrings) ...